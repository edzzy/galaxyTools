<tool id="rle" name="RLE" version="1.0.1">
  <description>for miccroarray matrix expression</description>
  <command interpreter="bash">r_wrapper.sh $script_file</command>

  <inputs>
      <param name="input" type="data" format="tabular" label="Dataset matrix"/>
	  <param name="out_prefix"  value="Boxplot" type="text" label="Title for the output file" size ="80" />
  </inputs>

  <configfiles>
    <configfile name="script_file">
    ## Setup R error handling to go to stderr
    options( show.error.messages=F,error = function () { cat( geterrmessage(), file=stderr() ); q( "no", 1, F ) } )
	## open MadPro library
##	suppressPackageStartupMessages(library(MadPro,quietly=TRUE,warn.conflicts=FALSE,verbose=FALSE))
	source("/home/ehirchaud/MadProDev/R/graph_png.R")
	mat = read.delim( "${input.file_name}",row.names=1 )
	mat = log2(mat)
	pmed = apply(mat, 1, median)
	mat = mat - pmed
	create_boxplot(mat,"${boxplot_file.file_name}", log = TRUE)	
	boxfiles = paste(getwd(),"/boxplot.jpg")
##	create_boxplot(mat,boxfiles)	
    </configfile>
  </configfiles>

  <outputs>
	  <data format="jpg" name="boxplot_file" label="boxplot_${out_prefix}.jpg" />
  </outputs>

    <tests>
        <test>
        </test>
    </tests>
<help>

</help>
</tool>
