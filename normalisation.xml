<tool id="normalisation" name="Normalisation" version="1.0.1">
  <description>for miccroarray matrix expression</description>
  <command interpreter="bash">r_wrapper.sh $script_file</command>

  <inputs>
      <param name="input" type="data" format="tabular" label="Dataset matrix"/>
       <param name="type" type="select" label="Normalisation Type" value="L" force_select="true" display="radio">
          <option value="L" >Lowess</option>
          <option value="Q">Quantile</option>
        </param>
  </inputs>

  <configfiles>
    <configfile name="script_file">
      ## Setup R error handling to go to stderr
      options( show.error.messages=F,error = function () { cat( geterrmessage(), file=stderr() ); q( "no", 1, F ) } )
	   ## open MadPro library
	 # library(MadProDev,quietly=TRUE)
	 source("/home/ehirchaud/MadProDev/R/normalisation.R")
	 ## library(limma,quietly=TRUE)
        mat = read.delim( "${input.file_name}",row.names=1 )
		
		if("$type"=="Q"){
			mat=normQuantile(mat=mat,pngDir="./",img=FALSE)	
		}
		if("$type"=="L"){
			mat = LOWESS(data=mat,graph=0,projet="",pngDir="./")
		}
		write.table(mat,"${out_file}",sep="\t",quote=FALSE,row.names=TRUE,col.names=NA)
    </configfile>
  </configfiles>

  <outputs>
    <data format="tabular" name="out_file" value="matNorm.txt" />
  </outputs>

    <tests>
        <test>
        </test>
    </tests>
<help>

</help>
</tool>
