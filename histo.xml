<tool id="Histogramme" name="Histogramme" version="1.0.1">
  <description>for miccroarray matrix expression</description>
  <command interpreter="bash">r_wrapper.sh $script_file</command>

  <inputs>
  <param name="input" type="data" format="tabular" label="Dataset matrix"/>
  <param name="out_prefix"  value="histogramme" type="text" label="Title for the output file" size ="80"/>
  <param name="log_or_not" type="boolean" truevalue="TRUE" falsevalue="FALSE" checked="true" label="Log or not" help="Use this option if yours data are already in log.">
	  <option value="Already log">Already log</option>
  </param>
  <!--<param name="Histo_ech" type="boolean" truevalue="TRUE" falsevalue="FALSE" checked="true" label="One graph per sample" help="Use this option if you want to see the distribution of each sample separately.">
	  <option value="One graph per sample">One graph per sample</option>
  </param>-->
  <param name="title" type="text" value="Histogramme des distributions" label="Title for the graph" size="80"/>
  <param name="pas" type="text" value="0.2" label="Pas for the graph" size="6"/>
  </inputs>


	<configfiles>
	<configfile name="script_file">	
	## Setup R error handling to go to stderr
	options( show.error.messages=F,error = function () { cat( geterrmessage(), file=stderr() ); q( "no", 1, F ) } )
    ## open MadPro library
    library(MadPro,quietly=TRUE)
	source("/home/tmaroilley/MadProDev/R/graph_png.R")
	mat = read.delim( "${input.file_name}",row.names=1 )
	create_histo(data=mat,output_name="${histogramme_file.file_name}",path="", log=$log_or_not, pas=$pas, title="$title")
	HTML_img("${histogramme_file.file_name}","${html_file}")
	</configfile>
	</configfiles>

	<outputs>
		<data format="html" name="html_file" label="${out_prefix}.html" />
		<data format="jpg" name="histogramme_file" label="histogramme_${out_prefix}.jpg" />
	</outputs>

	<tests>
	<test>
	</test>
	</tests>

</tool>

